<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>高级拖拽</title>
<style>
	#div1{
		width: 500px;
		height: 500px;
		background: gray;
		position: relative;
	}
	#div2{
		width: 100px;
		height: 100px;
		background: red;
		position: absolute;
	}
	</style>
	<script>
	window.onload=function(){
		var oDiv1=document.getElementById('div1');
		var oDiv2=document.getElementById('div2');
		
		oDiv2.onmousedown=function(ev){
			var oEvent=ev||event;
			var posx=oEvent.clientX-oDiv2.offsetLeft;
			var posy=oEvent.clientY-oDiv2.offsetTop;
			
			document.onmousemove=function(ev){
				var oEvent=ev||event;
				var l=oEvent.clientX-posx;
				var t=oEvent.clientY-posy;
				
//				if(l<0){
				//磁性吸附 left和top实现磁性吸附
				if(l<50){
					l=0;
				}
				else if(l>oDiv1.offsetWidth-oDiv2.offsetWidth){
					l=oDiv1.offsetWidth-oDiv2.offsetWidth;
				}
				
				if(t<50){
					t=0;
				}
				else if(t>oDiv1.offsetHeight-oDiv2.offsetHeight){
					t=oDiv1.offsetHeight-oDiv2.offsetHeight;
				}
				
				
				oDiv2.style.left=l+'px';
				oDiv2.style.top=t+'px'; 
			};
			document.onmouseup=function(){
				document.onmousemove=null;
				document.onmouseup=null;
			};
		};
	};
	</script>
</head>

<body>
<div id="div1">
	<div id="div2">
		
	</div>
</div>
</body>
</html>
